import{j as e,r as n,b as G,B as v,E as p,c as N,d as U}from"./index-CW624MtL.js";const P="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.33339%2010.6667L16.5001%201.5M7.33339%2010.6667L10.2501%2016.5C10.2866%2016.5798%2010.3453%2016.6474%2010.4192%2016.6948C10.493%2016.7422%2010.579%2016.7674%2010.6667%2016.7674C10.7545%2016.7674%2010.8404%2016.7422%2010.9143%2016.6948C10.9881%2016.6474%2011.0468%2016.5798%2011.0834%2016.5L16.5001%201.5M7.33339%2010.6667L1.50006%207.75C1.42027%207.71344%201.35266%207.65474%201.30526%207.58088C1.25786%207.50701%201.23267%207.4211%201.23267%207.33333C1.23267%207.24557%201.25786%207.15965%201.30526%207.08579C1.35266%207.01193%201.42027%206.95323%201.50006%206.91667L16.5001%201.5'%20stroke='white'%20strokeWidth='1.66667'%20strokeLinecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",R="_background_1mtd0_1",$="_form__wrap_1mtd0_18",J="_chat__form_1mtd0_14",W="_form__submit_1mtd0_42",m={background:R,"chat__form-container":"_chat__form-container_1mtd0_14",form__wrap:$,chat__form:J,form__submit:W,"radio-group":"_radio-group_1mtd0_56","answer-list":"_answer-list_1mtd0_72"},q="_checked_1mwrp_16",E={"radio-container":"_radio-container_1mwrp_1",checked:q};function j(c){const{name:i,id:r,title:l,children:d,checked:u,onChange:f}=c;return e.jsxs("div",{className:E["radio-container"],children:[e.jsxs("label",{className:u?E.checked:"",htmlFor:r,children:[d,l]}),e.jsx("input",{type:"radio",name:i,id:r,checked:u,onChange:()=>f(r),value:r})]})}const z="/assets/doughnut-DgIgdJ0C.svg",K="data:image/svg+xml,%3csvg%20width='26'%20height='26'%20viewBox='0%200%2026%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20filter='url(%23filter0_d_50_70)'%3e%3cpath%20d='M8.00007%204.89178C9.40082%204.08336%2011.0477%203.8117%2012.6339%204.12742C14.22%204.44313%2015.6374%205.32469%2016.6218%206.60785C17.6062%207.89102%2018.0907%209.48829%2017.9848%2011.1021C17.879%2012.7159%2017.1901%2014.2363%2016.0465%2015.3799C14.9029%2016.5235%2013.3826%2017.2124%2011.7687%2017.3182C10.1549%2017.424%208.55764%2016.9396%207.27448%2015.9552C5.99131%2014.9707%205.10976%2013.5534%204.79404%2011.9672C4.47833%2010.3811%204.74999%208.73419%205.5584%207.33344'%20stroke='black'%20strokeWidth='1.25'%20strokeLinecap='round'/%3e%3cpath%20d='M21.3334%200.666748H21.9584C21.9584%200.500988%2021.8926%200.342017%2021.7754%200.224806C21.6582%200.107596%2021.4992%200.041748%2021.3334%200.041748V0.666748ZM20.7084%204.83341C20.7084%204.99918%2020.7743%205.15815%2020.8915%205.27536C21.0087%205.39257%2021.1677%205.45841%2021.3334%205.45841C21.4992%205.45841%2021.6582%205.39257%2021.7754%205.27536C21.8926%205.15815%2021.9584%204.99918%2021.9584%204.83341H20.7084ZM17.1668%200.041748C17.001%200.041748%2016.842%200.107596%2016.7248%200.224806C16.6076%200.342017%2016.5418%200.500988%2016.5418%200.666748C16.5418%200.832508%2016.6076%200.99148%2016.7248%201.10869C16.842%201.2259%2017.001%201.29175%2017.1668%201.29175V0.041748ZM16.3584%206.52508L21.7751%201.10841L20.8918%200.225081L15.4751%205.64175L16.3584%206.52508ZM20.7084%200.666748V4.83341H21.9584V0.666748H20.7084ZM17.1668%201.29175H21.3334V0.041748H17.1668V1.29175Z'%20fill='black'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d_50_70'%20x='0.0407715'%20y='0.041748'%20width='25.9177'%20height='25.9158'%20filterUnits='userSpaceOnUse'%20colorInterpolationFilters='sRGB'%3e%3cfeFlood%20floodOpacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'/%3e%3cfeOffset%20dy='4'/%3e%3cfeGaussianBlur%20stdDeviation='2'/%3e%3cfeComposite%20in2='hardAlpha'%20operator='out'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200.25%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow_50_70'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow_50_70'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e",Q="data:image/svg+xml,%3csvg%20width='22'%20height='27'%20viewBox='0%200%2022%2027'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20filter='url(%23filter0_d_50_61)'%3e%3cpath%20d='M8.75098%2014.1259C8.58522%2014.1259%208.42625%2014.1918%208.30904%2014.309C8.19182%2014.4262%208.12598%2014.5852%208.12598%2014.7509C8.12598%2014.9167%208.19182%2015.0757%208.30904%2015.1929C8.42625%2015.3101%208.58522%2015.3759%208.75098%2015.3759V14.1259ZM12.9176%2015.3759C13.0834%2015.3759%2013.2424%2015.3101%2013.3596%2015.1929C13.4768%2015.0757%2013.5426%2014.9167%2013.5426%2014.7509C13.5426%2014.5852%2013.4768%2014.4262%2013.3596%2014.309C13.2424%2014.1918%2013.0834%2014.1259%2012.9176%2014.1259V15.3759ZM10.2093%2017.6676C10.2093%2017.8334%2010.2752%2017.9923%2010.3924%2018.1095C10.5096%2018.2268%2010.6685%2018.2926%2010.8343%2018.2926C11.0001%2018.2926%2011.159%2018.2268%2011.2763%2018.1095C11.3935%2017.9923%2011.4593%2017.8334%2011.4593%2017.6676H10.2093ZM10.2093%2012.6676V14.7509H11.4593V12.6676H10.2093ZM10.8343%2014.1259H8.75098V15.3759H10.8343V14.1259ZM12.9176%2014.1259H10.8343V15.3759H12.9176V14.1259ZM10.2093%2014.7509V17.6676H11.4593V14.7509H10.2093Z'%20fill='black'/%3e%3cpath%20d='M7.91764%201.78098C9.14331%201.07365%2010.5843%200.835987%2011.9722%201.11226C13.3601%201.38854%2014.6002%202.15991%2015.4616%203.28268C16.3229%204.40545%2016.7468%205.80306%2016.6542%207.21514C16.5616%208.62723%2015.9588%209.9575%2014.9581%2010.9581C13.9575%2011.9588%2012.6272%2012.5616%2011.2151%2012.6542C9.80306%2012.7468%208.40545%2012.3229%207.28268%2011.4616C6.15991%2010.6002%205.38854%209.36008%205.11226%207.97219C4.83599%206.5843%205.07365%205.14331%205.78098%203.91764'%20stroke='black'%20strokeWidth='1.25'%20strokeLinecap='round'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d_50_61'%20x='0.375'%20y='0.375'%20width='20.9167'%20height='25.9176'%20filterUnits='userSpaceOnUse'%20colorInterpolationFilters='sRGB'%3e%3cfeFlood%20floodOpacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'/%3e%3cfeOffset%20dy='4'/%3e%3cfeGaussianBlur%20stdDeviation='2'/%3e%3cfeComposite%20in2='hardAlpha'%20operator='out'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200.25%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow_50_61'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow_50_61'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e";function X(){return e.jsxs("svg",{width:"26",height:"26",viewBox:"0 0 26 26",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsxs("g",{filter:"url(#filter0_d_50_70)",children:[e.jsx("path",{d:"M8.00007 4.89178C9.40082 4.08336 11.0477 3.8117 12.6339 4.12742C14.22 4.44313 15.6374 5.32469 16.6218 6.60785C17.6062 7.89102 18.0907 9.48829 17.9848 11.1021C17.879 12.7159 17.1901 14.2363 16.0465 15.3799C14.9029 16.5235 13.3826 17.2124 11.7687 17.3182C10.1549 17.424 8.55764 16.9396 7.27448 15.9552C5.99131 14.9707 5.10976 13.5534 4.79404 11.9672C4.47833 10.3811 4.74999 8.73419 5.5584 7.33344",stroke:"black",strokeWidth:"1.25",strokeLinecap:"round"}),e.jsx("path",{d:"M21.3334 0.666748H21.9584C21.9584 0.500988 21.8926 0.342017 21.7754 0.224806C21.6582 0.107596 21.4992 0.041748 21.3334 0.041748V0.666748ZM20.7084 4.83341C20.7084 4.99918 20.7743 5.15815 20.8915 5.27536C21.0087 5.39257 21.1677 5.45841 21.3334 5.45841C21.4992 5.45841 21.6582 5.39257 21.7754 5.27536C21.8926 5.15815 21.9584 4.99918 21.9584 4.83341H20.7084ZM17.1668 0.041748C17.001 0.041748 16.842 0.107596 16.7248 0.224806C16.6076 0.342017 16.5418 0.500988 16.5418 0.666748C16.5418 0.832508 16.6076 0.99148 16.7248 1.10869C16.842 1.2259 17.001 1.29175 17.1668 1.29175V0.041748ZM16.3584 6.52508L21.7751 1.10841L20.8918 0.225081L15.4751 5.64175L16.3584 6.52508ZM20.7084 0.666748V4.83341H21.9584V0.666748H20.7084ZM17.1668 1.29175H21.3334V0.041748H17.1668V1.29175Z",fill:"black"})]}),e.jsx("defs",{children:e.jsxs("filter",{id:"filter0_d_50_70",x:"0.0407715",y:"0.041748",width:"25.9177",height:"25.9158",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[e.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),e.jsx("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),e.jsx("feOffset",{dy:"4"}),e.jsx("feGaussianBlur",{stdDeviation:"2"}),e.jsx("feComposite",{in2:"hardAlpha",operator:"out"}),e.jsx("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"}),e.jsx("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_50_70"}),e.jsx("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_50_70",result:"shape"})]})})]})}function Y(){return e.jsxs("svg",{width:"22",height:"27",viewBox:"0 0 22 27",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsxs("g",{filter:"url(#filter0_d_50_61)",children:[e.jsx("path",{d:"M7.91764 1.78098C9.14331 1.07365 10.5843 0.835987 11.9722 1.11226C13.3601 1.38854 14.6002 2.15991 15.4616 3.28268C16.3229 4.40545 16.7468 5.80306 16.6542 7.21514C16.5616 8.62723 15.9588 9.9575 14.9581 10.9581C13.9575 11.9588 12.6272 12.5616 11.2151 12.6542C9.80306 12.7468 8.40545 12.3229 7.28268 11.4616C6.15991 10.6002 5.38854 9.36008 5.11226 7.97219C4.83599 6.5843 5.07365 5.14331 5.78098 3.91764",stroke:"black",strokeWidth:"1.25",strokeLinecap:"round"}),e.jsx("path",{d:"M8.75098 14.1259C8.58522 14.1259 8.42625 14.1918 8.30904 14.309C8.19182 14.4262 8.12598 14.5852 8.12598 14.7509C8.12598 14.9167 8.19182 15.0757 8.30904 15.1929C8.42625 15.3101 8.58522 15.3759 8.75098 15.3759V14.1259ZM12.9176 15.3759C13.0834 15.3759 13.2424 15.3101 13.3596 15.1929C13.4768 15.0757 13.5426 14.9167 13.5426 14.7509C13.5426 14.5852 13.4768 14.4262 13.3596 14.309C13.2424 14.1918 13.0834 14.1259 12.9176 14.1259V15.3759ZM10.2093 17.6676C10.2093 17.8334 10.2752 17.9923 10.3924 18.1095C10.5096 18.2268 10.6685 18.2926 10.8343 18.2926C11.0001 18.2926 11.159 18.2268 11.2763 18.1095C11.3935 17.9923 11.4593 17.8334 11.4593 17.6676H10.2093ZM10.2093 12.6676V14.7509H11.4593V12.6676H10.2093ZM10.8343 14.1259H8.75098V15.3759H10.8343V14.1259ZM12.9176 14.1259H10.8343V15.3759H12.9176V14.1259ZM10.2093 14.7509V17.6676H11.4593V14.7509H10.2093Z",fill:"black"})]}),e.jsx("defs",{children:e.jsxs("filter",{id:"filter0_d_50_61",x:"0.375",y:"0.375",width:"20.9167",height:"25.9176",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[e.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),e.jsx("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),e.jsx("feOffset",{dy:"4"}),e.jsx("feGaussianBlur",{stdDeviation:"2"}),e.jsx("feComposite",{in2:"hardAlpha",operator:"out"}),e.jsx("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"}),e.jsx("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_50_61"}),e.jsx("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_50_61",result:"shape"})]})})]})}const e0=[{id:"male",icon:K,type:"남성",value:1,group:"sex",Component:e.jsx(X,{})},{id:"female",type:"여성",icon:Q,value:2,group:"sex",Component:e.jsx(Y,{})},{id:"outer",type:"기타",value:0,group:"sex"}],s0="_overlay_1ns9t_1",t0="_survey_1ns9t_11",o0="_survey__form_1ns9t_45",r0="_date_1ns9t_67",n0="_form__label_1ns9t_74",a0="_form__cancel_1ns9t_98",c0="_form__submit_1ns9t_99",i0="_disabled_1ns9t_100",l0="_selected_1ns9t_146",h={overlay:s0,survey:t0,survey__form:o0,date:r0,form__label:n0,"form__button-container":"_form__button-container_1ns9t_91",form__cancel:a0,form__submit:c0,disabled:i0,selected:l0};function d0(c){const{onClose:i}=c,r=localStorage.getItem("accessToken"),[l,d]=n.useState("g1"),[u,f]=n.useState("");function k(a){const _=a.target;f(_.value)}function x(a){d(a)}const g=!u||!l;async function w(a){a.preventDefault();try{await fetch(p+"/users/profile",{method:"PUT",headers:{"Content-Type":"application/json",tkn:r},body:JSON.stringify({birth:u,sex:l})}),i()}catch{throw new Error("설문조사에 실패했습니다.")}}return G.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:h.overlay}),e.jsxs("section",{className:h.survey,children:[e.jsx("header",{children:e.jsxs("p",{children:["생년월일과 성별을 입력해주시면, ",e.jsx("br",{}),e.jsx("strong",{children:"추천"}),"에 큰 도움이돼요!"]})}),e.jsxs("form",{className:h.survey__form,onSubmit:w,children:[e.jsxs("section",{children:[e.jsx("label",{htmlFor:"born",className:h.form__label,children:"생년월일"}),e.jsx("input",{type:"date",id:"born",value:u,onChange:k,className:u?h.selected:h.date})]}),e.jsxs("section",{children:[e.jsx("label",{htmlFor:"gender",className:h.form__label,children:"성별을 선택해주세요."}),e.jsx("ul",{children:e0.map(a=>{const _=a.Component;return e.jsx(j,{title:a.type,onChange:()=>x(a.id),checked:l===a.id,...a,children:_},a.id)})})]}),e.jsxs("div",{className:h["form__button-container"],children:[e.jsx(v,{type:"button",className:h.form__cancel,onClick:i,children:"다음에 할래요!"}),e.jsxs(v,{className:g?h.disabled:h.form__submit,disabled:g,children:[e.jsx("img",{src:z,alt:"제출"}),e.jsx("span",{children:"제출"})]})]})]})]})]}),document.getElementById("modal-root"))}const f0="_card_c6r4p_1",h0={card:f0},u0=n.memo(function(i){const{children:r,onClick:l}=i;return e.jsx("li",{className:h0.card,onClick:l,children:r})}),m0=u0;async function _0(c,i){if(!c||!i)throw new Error("토큰이 없습니다");console.log("토큰재발급");try{const r=await fetch(p+"/auth/token/reissue",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessToken:c,refreshToken:i})});if(console.log(JSON.stringify({accessToken:c,refreshToken:i})),!r.ok){const d=await r.text();throw console.error("서버 오류 응답:",d),console.log(r),new Error(`서버 오류: ${r.status}, 응답: ${d} ${r}`)}const l=await r.json();return{accessToken:l.accessToken,refreshToken:l.refreshToken}}catch(r){throw r instanceof Error?new Error(r.message):new Error("알 수 없는 오류 발생")}}function x0(){const[c,i]=n.useState("전체"),[r,l]=n.useState("전체"),[d,u]=n.useState("전체"),[f,k]=n.useState(()=>localStorage.getItem("accessToken")),[x,g]=n.useState(()=>localStorage.getItem("refreshToken")),[w,a]=n.useState([]),[_,Z]=n.useState([]),[S,O]=n.useState([]),[b,M]=n.useState(""),[T,V]=n.useState([]),[F,y]=n.useState(!1),L=N(s=>s.setUser);function I(){y(!1)}const C=N(s=>s.accessToken)||localStorage.getItem("accessToken");n.useEffect(()=>{C||window.location.replace("/")},[C]),n.useEffect(()=>{(async function(){try{const o=await(await fetch(p+"/foods/meta")).json();a(o.metaData.scenarios),Z(o.metaData.times),O(o.metaData.types)}catch(t){if(t instanceof Error)throw new Error(t.message)}})()},[]),n.useEffect(()=>{C||C&&window.location.replace("/"),y(!0)},[C]);async function A(s){if(s.preventDefault(),!f||!x)throw new Error("토큰이 없습니다");try{const t=await fetch(p+"/foods/recommend",{method:"POST",headers:{"Content-Type":"application/json",tkn:f},body:JSON.stringify({previousAnswer:b,scenario:c,time:r,type:d})});if(t.status===401)try{const o=await _0(f,x);if(!o.accessToken||!o.refreshToken)throw new Error("토큰이 정의되지 않았습니다.");console.log("newTokens",o),k(o.accessToken),g(o.refreshToken),L(o.accessToken);const H=await fetch(p+"/foods/recommend",{method:"POST",headers:{"Content-Type":"application/json",tkn:o.accessToken},body:JSON.stringify({previousAnswer:b,scenario:c,time:r,type:d})});if(H.ok){const B=await H.json();V(B.foodNames),M(()=>B.foodNames.join(", "))}}catch(o){throw console.error("토큰 갱신 실패:",o),new Error("토큰 갱신에 실패했습니다.")}if(t.ok){const o=await t.json();console.log(o),V(o.foodNames),M(()=>o.foodNames.join(", "))}}catch(t){t instanceof Error&&console.error(t.message)}}n.useEffect(()=>{if(f===null||x===null)throw new Error("토큰이 없습니다");(async function(){try{const o=await(await fetch(p+"/users/check",{method:"GET",headers:{tkn:f}})).json();o.sex&&o.birth&&(console.log(o.sex&&o.birth),y(!1))}catch(t){t instanceof Error&&console.error(t.message)}})()},[]);async function D(s){try{console.log(f);const t=await fetch(p+"/foods/select",{method:"POST",headers:{"Content-Type":"application/json",tkn:f},body:JSON.stringify({name:s,scenario:c,time:r,type:d})}),o=await t.json();if(!t.ok)throw console.error("Error:",o),new Error(o.message||"Unknown error occurred");console.log("Success:",o)}catch(t){console.error(t)}}return e.jsxs("section",{className:m.background,children:[F&&e.jsx(d0,{onClose:I}),e.jsx("main",{className:m["answer-list"],children:T&&T.map((s,t)=>e.jsx(m0,{onClick:()=>D(s),children:s},"_"+t))}),e.jsx("section",{className:m["chat__form-container"],children:e.jsxs("form",{className:m.chat__form,onSubmit:A,children:[e.jsxs("section",{children:[e.jsx("strong",{children:"상황"}),e.jsx("div",{className:m["radio-group"],children:w&&w.map((s,t)=>e.jsx(j,{id:")"+s+t,name:"scenario",value:s,title:s,checked:s===c,onChange:()=>i(s),onClick:()=>{}},")"+s+t))})]}),e.jsxs("section",{children:[e.jsx("strong",{children:"시간"}),e.jsx("div",{className:m["radio-group"],children:_&&_.map((s,t)=>e.jsx(j,{id:"-"+s+t,name:"times",title:s,value:s,checked:s===r,onChange:()=>l(s)},"-"+s+t))})]}),e.jsxs("section",{children:[e.jsx("strong",{children:"카테고리"}),e.jsx("div",{className:m["radio-group"],children:S&&S.map((s,t)=>e.jsx(j,{id:"+"+s+t,name:"types",value:s,title:s,checked:s===d,onChange:()=>u(s)},"+"+s+t))})]}),e.jsx("div",{className:m.form__wrap,children:e.jsx(v,{className:m.form__submit,children:e.jsx("img",{src:P,alt:"추천 받기"})})})]})}),e.jsx(U,{to:"/logout",children:"로그아웃"})]})}export{x0 as default};
